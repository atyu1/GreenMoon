# GreenMoon
Home Monitoring System with Raspberry Pi sensors

## Overview
Goal of this project is to code the raspberry pi 2-3-4 part to read from sensors.
Ultimate goal is to automate the deployment of the code with Docker/Kubernetes so managing and using
sensors is fully automated leveraging Microservices Framework.

`GreenOrbit` project is not yet developed, can be a local server per site to be able to collect data from sensors
which are not network accessible, like bluetooth sensors.

`GreenPlanet` project is to give server side code, where we will collect the data and send notificatons.
<TBD> Add URL for github

`GreenStar` project is to have a central server which will configure the new raspbians.
<TBD> Add URL for github

----------------------------------
## Supported Sensors
 - DHT11 (Planned)
 - TBD

## Using the code
 - Code is based on Sensors and Handlers
 - Sensors read the data
 - Handlers give different interface options to communicate with custom servers or GreenPlanet

## Collected Data Format
- Json formated data points from raw sensors
```
{
	"data": [
		"sensorname1": "value1",
		"sensorname2": "value2"
	]
}
```

- Json formated data points collected from handlers
 ```
{
	'timestamp': < float > ,
	'location': < string > ,
	'room': < string > ,
	'name': < string > ,
	'datapoints': [{
		'sensor': < string > ,
		'value': < real / float >
	}, {
		'sensor': < string > ,
		'value': < real / float >
	}]
}
  ```

`Explanation:`
- location = provides multi tenancy (multisite) deployment
- room = place inside the location
- name = sensor name, just for redundancy if we add 2 or more same sensor type device
- sensor = sensor type like: humidity, temperature, fire, smoke, ...
- value = value generated by sensor or recalculated

## Global Variables
Global variables is used to configure the sensors to give info for various connectivity things.
<TBD> Add list of variables

## Requirements (before virtualenv or requirerements.txt)
- Remove me when requirements file presents
pip3 install adafruit-circuitpython-dht
sudo apt-get install libgpiod2


## Docker building
We use sensor based building to avoid to much overhead per container.
We don't wanna load all the sensor files.
Create your snesor file and name as: dht11.py (for sensor) and app_dht11.py (for app)


After run:
 ```docker build --build-arg sensor_name=dht11 -t greenmoon-dht11 .```

## Docker running
Running a container requires to source the env variables from .env file.

Example:
``` docker run --env-file .env --name greenmoon-dht11 ```